"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in r)return r.value;var i=r.get;return void 0!==i?i.call(n):void 0};custom_plugins.PluginLoader.getInstance().addPlugin(function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.VERSION="1.2",e.URL="http://duelyst.r4nd0m.org/page/duelyst_plugins/actions-left-info",_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addListener",e).call(e,e.prepare,window.custom_plugins.eventHooks.SESSION_CREATED),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addListener",e).call(e,e.infuse_dom,window.custom_plugins.eventHooks.SESSION_CREATED.SHOW_ACTIVE_GAME),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addListener",e).call(e,e.update_data,window.custom_plugins.eventHooks.SESSION_CREATED.END_STEP),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addListener",e).call(e,e.toggle_box,window.custom_plugins.eventHooks.SESSION_CREATED.SHOW_START_TURN),e}return _inherits(t,e),_createClass(t,[{key:"toggle_box",value:function(){this.getIsMyTurn()?$("#plugin_ali_box").show():$("#plugin_ali_box").hide()}},{key:"prepare",value:function(){custom_plugins.loadStylesheet("plugins/boxes-1.0.css.html")}},{key:"infuse_dom",value:function(){$(document.createElement("div")).addClass("ingame_infobox").attr("id","plugin_ali_box").draggable().appendTo($("#app-game-right-region"))}},{key:"update_data",value:function(){if(this.getMyPlayer().isCurrentPlayer){var e=this,t=this.getMyPlayer().getRemainingMana(),o=!1,n=this.getMyPlayer().deck._private.cachedCardsInHandExcludingMissing;for(var r in n)n[r].manaCost<=t&&(o=!0);var a=!1;for(var i in e.currentTurn.steps)"ReplaceCardFromHandAction"===e.currentTurn.steps[i].action.type&&(a=!0);a||0!==this.getMyPlayer().deck.hand.filter(function(e){return"number"==typeof e}).length||(a=!0);var s=e.getMyPlayer().signatureCardActive&&t>0,l=$(document.createElement("div")),u='<b style="text-decoration: underline;">Move/Attack with:</b>';l.append(u);var p=e.board.getCards(),c=0;for(var d in p)p[d].ownerId===ProfileManager.instance.profile.id&&(p[d].getIsExhausted()||0===e.board.getEnemyEntitiesAroundEntity(e.board.getCards()[d]).length&&!p[d].getCanMove()&&!p[d].isRanged()||p[d].getIsBattlePet()||($(document.createElement("div")).text(p[d].name).data({x:p[d].position.x,y:p[d].position.y}).on("mouseenter",function(){var e=$(this).data("x"),t=$(this).data("y");custom_plugins.exposed.FXCompositeLayer.ctor.showInstructionalArrowForEntityNode(custom_plugins.exposed.FXCompositeLayer.ctor.getEntityNodeAtBoardPosition(e,t))}).appendTo(l),c++));!c&&l.append("<br/>&mdash;"),$("#plugin_ali_box").html('<b style="text-decoration: underline;">Actions left:</b><br/>'+(o?"* Play a card<br/>":"")+(a?"":"* Replace<br/>")+(s?"* Bloodborn Spell<br/>":"")+(o||!a||s?"":"&mdash;<br/>")),l.appendTo($("#plugin_ali_box")),!o&&a&&!s&&0===c&&l.append('<br/><b style="color:green">No action left</b>')}}}]),t}(custom_plugins.Plugin));